<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>حاسبة المباني – بطاقة كفاءة الطاقة</title>
  
  <style>
    :root{ --mew-primary:#0aa4b5; --mew-accent:#123e7a; --mew-bg:#f4fbfc; --card:#fff; --text:#0f172a; --muted:#5b6b7b; --radius:18px; --shadow:0 10px 30px rgba(8,56,84,.07); --shadow-soft:0 8px 20px rgba(8,56,84,.06) }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--mew-bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Kufi Arabic","Noto Sans Arabic",Tahoma,Arial,sans-serif}
    a{color:var(--mew-accent);text-decoration:none}
    header{position:sticky;top:0;z-index:30;background:linear-gradient(90deg,var(--mew-primary),var(--mew-accent));color:#fff;box-shadow:var(--shadow)}
    .container{max-width:1120px;margin:auto;padding:16px}
    .topbar{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:12px;background:#fff;display:grid;place-items:center}
    .logo svg{width:28px;height:28px;fill:var(--mew-primary)}
    .title{font-weight:800;font-size:20px}
    nav{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px}
    .pill{background:rgba(255,255,255,.14);border:1px solid rgba(255,255,255,.25);padding:10px 14px;border-radius:999px;color:var(--text);cursor:pointer}
    .pill:hover{background:rgba(255,255,255,.22)}
    main{padding:26px 0}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:var(--radius);padding:16px;border:1px solid #e8f0f3;box-shadow:var(--shadow-soft)}
    .card h2{margin:0 0 12px;font-size:22px}
    .field{display:grid;gap:6px;margin-bottom:12px}
    .field label{font-weight:700}
    .field input{padding:12px 12px;border:1px solid #d7e3e9;border-radius:12px;font-size:15px}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .btn{display:inline-flex;gap:8px;align-items:center;justify-content:center;padding:12px 16px;border-radius:14px;border:1px solid #e9f3f6;background:#fff;color:var(--mew-accent);box-shadow:var(--shadow-soft);cursor:pointer;font-weight:800}
    .result{display:grid;gap:10px}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid #e8eef2;background:#f7fbfd;font-weight:800}
    .rating{font-size:46px;font-weight:900;letter-spacing:1px}
    .rating.good{color:#059669}.rating.mid{color:#d97706}.rating.bad{color:#dc2626}
    .ratingbar{position:relative;margin-top:10px;border-radius:14px;overflow:visible;border:1px solid #e0ebf0;background:#fff;padding:0}
    .ratingbar img.bar{display:block;width:100%;height:auto}
    .ship-pointer{position:absolute;left:88%;transform:translateX(6px) translateY(-50%);width:42px;height:42px;display:grid;place-items:center;pointer-events:none}
    .ship-line{position:absolute;left:88%;width:6px;height:2px;background:#0aa4b5;transform:translateY(-50%);}
    .ship-pointer svg{width:38px;height:38px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.15))}
    .ship-note{margin-top:6px;font-size:12px;color:#6b7f90}
    footer{margin:36px 0 24px;color:#8091a2;font-size:13px;text-align:center}
  </style>

</head>
<body>
  
  <header>
    <div class="container">
      <div class="topbar">
        <div class="logo" aria-label="شعار">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2l7 4v6c0 5-3.5 9.5-7 10-3.5-.5-7-5-7-10V6l7-4zm0 4l-4 2.3v3.6c0 3.5 2.3 7 4 7s4-3.5 4-7V8.3L12 6z"/></svg>
        </div>
        <div class="title">بطاقة كفاءة الطاقة للمباني – إدارة الطاقة المتجددة و كفاءة الطاقة</div>
      </div>
      <nav>
        <a class="pill" href="index.html">ما هي البطاقة؟</a>
        <a class="pill" href="#" style="background:#fff;color:var(--mew-accent);border-color:#fff">حاسبة المباني</a>
        <a class="pill" href="appliance-savings.html">حاسبة الأجهزة</a>
        <a class="pill" href="faq.html">الأسئلة الشائعة</a>
      </nav>
    </div>
  </header>

  
<main class="container">
  <div class="grid">
    <section class="card">
      <h2>بيانات المبنى</h2>
      <div class="field"><label for="annual_kwh">إجمالي استهلاك الكهرباء السنوي (كيلوواط‑ساعة/سنة)</label><input id="annual_kwh" type="text" placeholder="مثال: 48000"/></div>
      <div class="field"><label for="area">مساحة المبنى الإجمالية (متر مربع)</label><input id="area" type="text" placeholder="مثال: 240"/></div>
      <div class="row"><button class="btn" id="calc">احسب الكثافة والتصنيف</button><button class="btn" id="reset">إعادة تعيين</button></div>
    </section>

    <section class="card">
      <h2>النتائج</h2>
      <div class="result">
        <div class="badge">كثافة استهلاك الطاقة السنوي (EUI): <span id="eui_value" lang="en" style="font-weight:900;margin-inline-start:8px; direction:ltr; unicode-bidi:embed; font-family:Arial, sans-serif;">—</span> kWh/م²·سنة</div>
        <div>التصنيف: <span id="rating" class="rating">—</span></div>

        <div class="ratingbar" id="ratingbar">
          <img class="bar" src="assets/rating-bar.png" alt="شريط التصنيفات من أ إلى ز"/>
          <div class="ship-line" id="shipLine" style="top:50%"></div>
          <div class="ship-pointer" id="ship" style="top:50%;display:none" aria-hidden="true">🚢</div>
        </div>
        <div class="ship-note">* مؤشر السفينة يتحرك عموديًا بجانب الشريط ليوضح الفئة.</div>
      </div>
    </section>
  </div>
</main>

<script>
  function toLatinDigits(str){
    if(typeof str !== 'string') str = String(str || '');
    const map = {'٠':'0','١':'1','٢':'2','٣':'3','٤':'4','٥':'5','٦':'6','٧':'7','٨':'8','٩':'9','۰':'0','۱':'1','۲':'2','۳':'3','۴':'4','۵':'5','۶':'6','۷':'7','۸':'8','۹':'9'};
    return str.replace(/[٠-٩۰-۹]/g, d => map[d]).replace(/[,٫]/g,'.').replace(/[^\d.\-]/g,'');
  }
  function numVal(el){ return parseFloat(toLatinDigits(el.value)); }

  const shipPosTop = { 'أ': 5, 'ب': 19, 'ج': 33, 'د': 47, 'هـ': 61, 'و': 75, 'ز': 89 };

  const annualInput = document.getElementById('annual_kwh');
  const areaInput   = document.getElementById('area');
  const calcBtn     = document.getElementById('calc');
  const resetBtn    = document.getElementById('reset');

  const euiValue = document.getElementById('eui_value');
  const ratingEl = document.getElementById('rating');
  const shipEl   = document.getElementById('ship');
  const lineEl   = document.getElementById('shipLine');

  
  function classify(eui){
    const v = eui;
    if (v >= 1  && v <= 20) return 'أ';
    if (v >= 21 && v <= 35) return 'ب';
    if (v >= 36 && v <= 50) return 'ج';
    if (v >= 51 && v <= 66) return 'د';
    if (v >= 67 && v <= 80) return 'هـ';
    if (v >= 81 && v <= 92) return 'و';
    if (v >= 93)            return 'ز';
    return 'أ';
  }
function ratingTone(letter){ if(['أ','ب','ج'].includes(letter)) return 'good'; if(['د','هـ'].includes(letter)) return 'mid'; return 'bad'; }
function format(num){ return new Intl.NumberFormat('en-US', { maximumFractionDigits: 2 }).format(num); }

  function updatePointer(letter){
    const y = shipPosTop[letter] ?? 50;
    shipEl.style.top = y + '%';
    shipEl.style.display = 'block';
    lineEl.style.top = y + '%';
    if(['أ','ب'].includes(letter)) lineEl.style.background = '#16a34a';
    else if(['ج','د','هـ'].includes(letter)) lineEl.style.background = '#f59e0b';
    else lineEl.style.background = '#dc2626';
  }

  calcBtn.addEventListener('click', () => {
    const kwh = numVal(annualInput);
    const area = numVal(areaInput);
    if(!kwh || !area || kwh <= 0 || area <= 0){ alert('يرجى إدخال قيم صحيحة للاستهلاك السنوي والمساحة.'); return; }
    const eui = kwh / area;
    const letter = classify(eui);
    euiValue.textContent = format(eui);
    ratingEl.textContent = letter;
    ratingEl.className = 'rating ' + ratingTone(letter);
    updatePointer(letter);
  });

  resetBtn.addEventListener('click', () => {
    annualInput.value = '';
    areaInput.value = '';
    euiValue.textContent = '—';
    ratingEl.textContent = '—';
    ratingEl.className = 'rating';
    shipEl.style.display = 'none';
    lineEl.style.background = '#0aa4b5';
  });
</script>

  <footer>كل مبنى له بصمة طاقة، و خطوتنا تبدأ من كفاءته</footer>
</body>
</html>
